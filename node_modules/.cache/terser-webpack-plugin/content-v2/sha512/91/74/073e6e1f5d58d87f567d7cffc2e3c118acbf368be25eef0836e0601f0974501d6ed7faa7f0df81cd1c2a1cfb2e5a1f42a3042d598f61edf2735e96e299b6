{"code":"!function(e){var t={};function a(r){if(t[r])return t[r].exports;var l=t[r]={i:r,l:!1,exports:{}};return e[r].call(l.exports,l,l.exports,a),l.l=!0,l.exports}a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var l in e)a.d(r,l,function(t){return e[t]}.bind(null,l));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,\"a\",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p=\"\",a(a.s=14)}({14:function(e,t){!function(){var e={};let t=[];$(\"select:not(.normal)\").each((function(){$(\".select2_emp\").select2({dropdownParent:$(\".select2_emp\").parent()})})),$(\"#em_code\").val(getlocalItem(\"em_code\"));class a{static drow_dept_list(e){t=e;let a='<option label=\"Select Dept\"></option>';e.forEach((e,t)=>{a+=`<option value=\"${e.n_dep_id}\">${e.s_dep_name}</option>`}),$(\"#n_dep_id\").html(a)}static drow_emp_list(e){try{let t='<option label=\"Select Employee\"></option>';e.forEach((e,a)=>{t+=`<option value=\"${e.s_em_code}\">${e.s_em_code} (${e.name})</option>`}),$(\"#s_em_code\").html(t)}catch(e){alert(e)}}static drow_attach(e){try{let t=\"\";e.forEach((e,a)=>{let r=\"\";r=\"Completed\"===$(\"#s_status\").val()?\"none\":\"block\";var l=`${e.s_path}/${e.s_new_name}`;t+=`\\n                    <li href=\"${e.s_path}/${e.s_new_name}\"  class=\"d-flex  align-items-center\"> \\n                    <button type=\"button\" class=\"btn btn-sm\" onclick=\"delete_file(${e.n_temp_id})\" style=\"display:${0==check_string_val(e.n_temp_id,0)?\"none\":r}\">\\n                        <i class=\"far fa-trash-alt  text-danger\"></i>\\n                    </button> \\n                    <button type=\"button\" class=\"btn btn-sm\"  onclick=\"download_file('${l}','${e.s_ogi_name}')\">\\n                        <i class=\"far fa-arrow-alt-circle-down text-info\"></i>\\n                    </button> ${e.s_ogi_name}   \\n                    </li>`}),$(\"#file_upload\").html(t)}catch(e){alert(e)}}static task_list(e){try{let t=\"\";e.forEach((e,a)=>{t+=` \\n                                <tr> \\n                                    <td>\\n                                        <a href=\"#/tasks?task_key=${e.n_task_id}\">\\n                                            <i class=\"fas fa-edit\"></i> Task-l${e.n_task_id} ${e.s_task_name}\\n                                        </a>\\n                                    </td>\\n                                    <td>${ststus_text(e.s_priority)} ${e.s_priority}</td>\\n                                    <td>${ststus_text(e.s_status)} ${e.s_status}</td>\\n                                    <td>${e.created_by}</td>\\n                                    <td>${e.assign_to}</td>\\n                                    <td>${e.d_start_date}</td>\\n                                    <td>${e.d_due_date}</td>\\n                                </tr>`}),$(\"#task_list\").html(t)}catch(e){alert(e)}}static drow_timeline(e){var t=\"\";e.forEach((a,r)=>{let l=\"none\";e.length==r+1&&(l=getlocalItem(\"em_code\")==a.s_em_code?\"block\":\"none\"),t+=` \\n                        <div>\\n                            <i class=\"fas fa-envelope bg-blue\"></i>\\n                            <div class=\"timeline-item\">\\n                                <span class=\"time\"><i class=\"fas fa-clock\"></i> ${timeSince(new Date(a.created_datetime))}</span>\\n                                <h3 class=\"timeline-header\"><a href=\"javascript:void(0)\">${a.emp_name}</a></h3>\\n                                <div class=\"timeline-body\">\\n                                     ${a.s_comment}\\n                                </div>\\n                                <div class=\"timeline-footer\" style=\"display:${l}\" onclick=\"delete_comment(${a.n_com_id})\"> \\n                                    <a class=\"btn btn-danger btn-sm\">Delete</a>\\n                                </div>\\n                            </div>\\n                        </div>\\n                        \\x3c!-- END timeline item --\\x3e `}),$(\"#timeline_html\").html(t)}}get_attachemnt=t=>{try{e={role:getlocalItem(\"role\"),emp_code:getlocalItem(\"em_code\"),task_head:t},$.ajax({type:\"POST\",url:\"/task/get_attachemnt\",crossDomain:!0,data:e,beforeSend:function(){$(\"#file_upload\").html(\"\")},success:function(e){a.drow_attach(e.data),callAlert(\"success\",success_handling(e))},error:function(e){callAlert(\"error\",error_handling(e))},complete:function(e){}})}catch(e){callAlert(\"error\",error_handling(e))}},get_emp_list_by_dept=t=>{try{e={role:getlocalItem(\"role\"),emp_code:getlocalItem(\"em_code\"),dep:t.value||t,dep_head:getlocalItem(\"dep_head\"),tag:getlocalItem(\"tag\")},$.ajax({type:\"POST\",url:\"/task/get_emp_list_by_dept\",crossDomain:!0,data:e,beforeSend:function(){$(\"#s_em_code\").html(\"\")},success:function(e){a.drow_emp_list(e.data),callAlert(\"success\",success_handling(e))},error:function(e){callAlert(\"error\",error_handling(e))},complete:function(e){}})}catch(e){callAlert(\"error\",error_handling(e))}},$(\"#submit_leave\").click((function(){return btn=this.id,setTimeout(()=>{$(\"#task-form\").submit()},1e3),!0})),$(\"#submit_add_more\").click((function(){return btn=this.id,setTimeout(()=>{$(\"#task-form\").submit()},1e3),!0})),$.validator.addMethod(\"start_date\",(function(e,t){return new Date<new Date($(\"#d_start_date\").val())}),\"Date should be greater then today date.\"),$.validator.addMethod(\"greaterThan\",(function(e,t,a){return/Invalid|NaN/.test(new Date(e))?isNaN(e)&&isNaN($(a).val())||Number(e)>=Number($(a).val()):new Date(e)>=new Date($(a).val())}),\"Must be greater than or equal to Start date.\");var r=$(\"#task-form\").bind(\"invalid-form.validate\",(function(){alert(\"Your missed \"+r.numberOfInvalids()+\" input, see the details below red in color.\")})).validate({submitHandler:function(t){e={n_dep_id:$(\"#n_dep_id\").val(),s_task_name:$(\"#s_task_name\").val(),s_em_code:$(\"#s_em_code\").val(),d_start_date:$(\"#d_start_date\").val(),d_due_date:$(\"#d_due_date\").val(),s_task_desc:$(\"#s_task_desc\").val(),s_priority:$(\"#s_priority\").val(),s_status:$(\"#s_status\").val(),s_created_by:getlocalItem(\"em_code\")},$.ajax({type:\"POST\",url:\"/task/submit_task\",crossDomain:!0,data:e,beforeSend:function(){add_loader(\"loader\")},success:function(e){\"submit_leave\"==btn&&$(\".close_modal\").click(),callAlert(\"success\",success_handling(e)),setTimeout(()=>{clear_filed()},500)},error:function(e){callAlert(\"error\",error_handling(e))},complete:function(e){remove_loader(\"loader\"),$(\"#file_upload\").html(\"\")}})},rules:{n_dep_id:{required:!0},s_task_name:{required:!0,minlength:3,maxlength:400},s_em_code:{required:!0},d_start_date:{required:!0},d_due_date:{greaterThan:\"#d_start_date\"},s_task_desc:{required:!0,minlength:10,maxlength:1800},s_priority:{required:!0},s_status:{required:!0}},messages:{}});let l=\"\";clear_filed=()=>{$(\"#s_filter_task\").val(check_string_val(sessionStorage.getItem(\"filter_value\"),\"Assigned\")),$(\".if_edit\").show(),$(\".if_new\").hide(),$(\".title_name\").text(\"New\"),$(\"#n_dep_id\").val(\"\"),$(\"#s_task_name\").val(\"\"),$(\"#s_em_code\").val(\"\"),$(\"#d_start_date\").val(\"\"),$(\"#d_due_date\").val(\"\"),$(\"#s_task_desc\").val(\"\"),\"DH\"!=getlocalItem(\"dep_head\")&&$(\".cls_ret\").remove(),class{static get_dept_list(){try{e={role:getlocalItem(\"role\"),emp_code:getlocalItem(\"em_code\"),dep_head:getlocalItem(\"dep_head\"),tag:getlocalItem(\"tag\")},$.ajax({type:\"POST\",url:\"/task/get_dept_list\",crossDomain:!0,data:e,beforeSend:function(){},success:function(e){a.drow_dept_list(e.data),callAlert(\"success\",success_handling(e))},error:function(e){callAlert(\"error\",error_handling(e))},complete:function(){}})}catch(e){callAlert(\"error\",error_handling(error))}}}.get_dept_list(),get_filtered_task(),get_attachemnt(),setTimeout(()=>{l=getAllUrlParams(window.location),l.task_key?get_task_by_id(l.task_key):window.location=\"/main#/tasks\"},500)},calltemp=e=>{try{if(!e)return void callAlert(\"error\",error_handling(\"No response found !\"));var t=$(\"#\"+e).contents().find(\"pre\").html();if(!t)return void callAlert(\"error\",error_handling(\"No response found !\"));var a=this.JSON.parse(t);a.code?callAlert(\"error\",error_handling(a)):($(\"#fileupload\").val(\"\"),callAlert(\"success\",success_handling(a)),get_attachemnt()),btn_enable(\"#upload-button\"),remove_spinner(\"#snip_lod\")}catch(e){callAlert(\"error\",error_handling(e))}},get_upload=e=>{\"\"!=check_string_val($(\"#fileupload\").val(),\"\")&&setTimeout(()=>{btn_disable(\"#\"+e.id),add_spinner(\"#snip_lod\")},500)},delete_file=t=>{try{if(!confirm(\"Do you really want to delete the attachment ?\"))return void callAlert(\"success\",success_handling(\"File not deleted.\"));e={role:getlocalItem(\"role\"),emp_code:getlocalItem(\"em_code\"),id:t},$.ajax({type:\"POST\",url:\"/task/delete_file\",crossDomain:!0,data:e,beforeSend:function(){$(\"#file_upload\").html(\"\")},success:function(e){callAlert(\"success\",success_handling(e)),get_attachemnt()},error:function(e){callAlert(\"error\",error_handling(e))},complete:function(e){}})}catch(e){callAlert(\"error\",error_handling(e))}},get_task_by_id=t=>{try{e={role:getlocalItem(\"role\"),emp_code:getlocalItem(\"em_code\"),id:t,filter_task:$(\"#s_filter_task\").val(),dep_head:getlocalItem(\"dep_head\")},$.ajax({type:\"POST\",url:\"/task/get_task_by_id\",crossDomain:!0,data:e,beforeSend:function(){},success:function(e){if(!e.data)return callAlert(\"error\",error_handling(\"No Record Found\"));callAlert(\"success\",success_handling(e)),get_emp_list_by_dept(e.data.n_dep_id),$(\"#get_edit\").click(),$(\".if_edit\").hide(),$(\".if_new\").show(),\"Completed\"==e.data.s_status&&($(\"#update_task_status\").remove(),$(\"#drop_task_status\").remove(),$(\"#btn_add_comn\").remove()),e.data.s_created_by!=getlocalItem(\"em_code\")&&$(\"#drop_task_status\").remove(),\"Return\"==e.data.s_status&&($(\"#update_task_status\").remove(),$(\"#re_assign_task\").show()),setTimeout(()=>{$(\".title_name\").text(\"Edit\"),$(\"#n_dep_id\").val(e.data.n_dep_id),$(\"#s_task_name\").val(e.data.s_task_name),$(\"#s_em_code\").val(e.data.s_em_code),$(\".select2_emp\").select2().val(e.data.s_em_code).trigger(\"change\"),$(\"#d_start_date\").val(e.data.d_start_date),$(\"#d_due_date\").val(e.data.d_due_date),$(\"#s_task_desc\").val(e.data.s_task_desc),$(\"#s_remark\").val(e.data.s_remark)},200),$(\"#s_status\").val(e.data.s_status)},error:function(e){callAlert(\"error\",error_handling(e))},complete:function(e){get_comments(),get_attachemnt(t)}})}catch(e){callAlert(\"error\",error_handling(e))}},close_modal=()=>{$(\".close_modal\").click(),window.location=\"#/tasks\"},update_task_status=t=>{try{e={role:getlocalItem(\"role\"),emp_code:getlocalItem(\"em_code\"),s_status:$(\"#s_status\").val(),s_remark:$(\"#s_remark\").val(),task_id:l.task_key,ass_employee:$(\"#s_em_code\").val(),btn:t},$.ajax({type:\"POST\",url:\"/task/update_task\",crossDomain:!0,data:e,beforeSend:function(){},success:function(e){callAlert(\"success\",success_handling(e)),\"drop_task_status\"==t&&setTimeout(()=>{close_modal()},1e3)},error:function(e){callAlert(\"error\",error_handling(e))},complete:function(e){}})}catch(e){callAlert(\"error\",error_handling(e))}},$(\".update_task_status\").click((function(e){update_task_status(this.id)})),get_filtered_task=()=>{try{e={role:getlocalItem(\"role\"),emp_code:getlocalItem(\"em_code\"),filter_task:$(\"#s_filter_task\").val(),dep_head:getlocalItem(\"dep_head\")},$.ajax({type:\"POST\",url:\"/task/get_filtered_task\",crossDomain:!0,data:e,beforeSend:function(){},success:function(e){sessionStorage.setItem(\"filter_value\",$(\"#s_filter_task\").val()),a.task_list(e.data),callAlert(\"success\",success_handling(e))},error:function(e){callAlert(\"error\",error_handling(e))},complete:function(e){}})}catch(e){callAlert(\"error\",error_handling(e))}},send_comment_action=(t,a)=>{try{if(\"\"==check_string_val($(\"#s_comment\").val(),\"\"))return callAlert(\"error\",error_handling(\"Please Enter your comments !\"));e={role:getlocalItem(\"role\"),emp_code:getlocalItem(\"em_code\"),s_comment:$(\"#s_comment\").val(),task_id:l.task_key,com_id:t,tag:a},$.ajax({type:\"POST\",url:\"/task/send_comment\",crossDomain:!0,data:e,beforeSend:function(){},success:function(e){$(\"#s_comment\").val(\"\"),get_comments(),callAlert(\"success\",success_handling(e))},error:function(e){callAlert(\"error\",error_handling(e))},complete:function(){}})}catch(e){callAlert(\"error\",error_handling(error))}},get_comments=()=>{try{e={emp_code:getlocalItem(\"em_code\"),task_id:l.task_key},$.ajax({type:\"POST\",url:\"/task/get_comment\",crossDomain:!0,data:e,beforeSend:function(){},success:function(e){$(\"#s_comment\").val(\"\"),a.drow_timeline(e.data),callAlert(\"success\",success_handling(e))},error:function(e){callAlert(\"error\",error_handling(e))},complete:function(){}})}catch(e){callAlert(\"error\",error_handling(error))}},delete_comment=t=>{try{e={emp_code:getlocalItem(\"em_code\"),task_id:l.task_key,com_id:t},$.ajax({type:\"POST\",url:\"/task/delete_comment\",crossDomain:!0,data:e,beforeSend:function(){},success:function(e){callAlert(\"success\",success_handling(e))},error:function(e){callAlert(\"error\",error_handling(e))},complete:function(){get_comments()}})}catch(e){callAlert(\"error\",error_handling(error))}},clear_filed()}()}});","extractedComments":[]}